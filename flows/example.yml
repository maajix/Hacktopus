version: "1.0"
name: "Gather available URLs from Target"
description: "Find URLs, files, directories via crawling, fuzzing, return available non duplicate once"
tags:
  - recon
  - files
  - directories
  - active_scan

variables:
  url: "{{url}}"

container:
  first_stage:
    parallel: true
    description: "Execute first_stage"
    tasks:
      - alias: "paramspider:discover"
        options:
          - map:
            - url: domain
          - custom_func:
            - url_to_domain: url
            - some_func: some_param
      - command: "echo {{url}}"
      - flow: "child_flow"

  second_stage:
    description: "Execute second_stage"
    tasks:
      - command: "echo second_stage"